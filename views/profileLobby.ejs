<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Core War Web | Game Lobbies</title>
  </head>
  <body>
    <% if (user) { %>
      <h1>Game lobbies</h1>
      <p>Hey <i><%= user.name %></i>, here you can join this lobby</p>
    <% if (lobby) { %>
        <p>Lobby: <i><%= lobby.name %></i>, max players: <i><%= lobby.maxPlayers %></i></p>
        <% lobby.users.forEach(function (member) { %>
          <p>
            Member: <i><%= member.name %></i>
          </p>
    <% });} %>
    <% if (status) { %>
        <h2> <%= status %> </h2> <%
        if (status == 'nothing') { %>
          <p>Join this lobby <a href="/lobbies.html/<%= lobby._id %>/join">Join</a></p>
        <% }
        else if (status == 'member')
        { %>
          <p>Leave this lobby  <a href="/lobbies.html/<%= lobby._id %>/leave">Leave</a></p>
        <% }
        else if (status == 'creator')
        { %>
          <p>Start this lobby   <a href="/arena.html/<%= lobby._id %>">Start</a></p>

          <p>Erase this lobby  <a href="/lobbies.html/<%= lobby._id %>/erase">Erase</a></p>
        <% }
    } %>
      <p>Get back to <a href="/index.html">main page</a></p>
    <% } else { %>
      <h1>An error occured</h1>
        <p>Go back to the <a href="/index.html">main page</a></p>
    <% } %>
  </body>
  <script src="/socket.io/socket.io.js"></script>
  <script charset="UTF-8">
    var lobby = io.connect('http://localhost:8080/<%= lobby._id %>');
    if (lobby.connected == false)
      console.log("Not connected");
    console.log(lobby);
    if (lobby.connected == true)
      console.log("connected");
  </script>
</html>
